<!DOCTYPE html><!--YSYJJyAFFhJV4_z7mWwHv--><html lang="en" class="roboto_d24be3b7-module__pZO6tq__variable dark min-h-screen"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/ce62453a442c7f35-s.p.124b2306.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/96dc49eb77cf029f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/f1b4d49aa9e249c5.js"/><script src="/_next/static/chunks/9c7c6aa9d3a1d571.js" async=""></script><script src="/_next/static/chunks/aee6c7720838f8a2.js" async=""></script><script src="/_next/static/chunks/2ffc983c444794f6.js" async=""></script><script src="/_next/static/chunks/82abf2d65f5428ae.js" async=""></script><script src="/_next/static/chunks/turbopack-96e3df9b0bc84328.js" async=""></script><script src="/_next/static/chunks/f9fb6c03ee20c9cf.js" async=""></script><script src="/_next/static/chunks/55fdeabc380c794a.js" async=""></script><script src="/_next/static/chunks/fb65dc2edde1250e.js" async=""></script><script src="/_next/static/chunks/acbad84493a0396b.js" async=""></script><script src="/_next/static/chunks/8c93724b435ab242.js" async=""></script><script src="/_next/static/chunks/dab6b902f1f46a02.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/d2be314c3ece3fbe.js" async=""></script><link rel="preload" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&amp;icon_names=domino_mask" as="style"/><meta name="next-size-adjust" content=""/><title>Antoine&#x27;s Blog</title><meta name="description" content="A blog where I share my thoughts about deep learning and my interests."/><link rel="icon" href="/favicon.ico?favicon.722d4cfd.ico" sizes="257x256" type="image/x-icon"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&amp;icon_names=domino_mask"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script><style data-emotion="mui-global 102ry8v">@layer mui{:root{--mui-spacing:8px;--mui-shape-borderRadius:4px;--mui-shadows-0:none;--mui-shadows-1:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);--mui-shadows-2:0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);--mui-shadows-3:0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);--mui-shadows-4:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);--mui-shadows-5:0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12);--mui-shadows-6:0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);--mui-shadows-7:0px 4px 5px -2px rgba(0,0,0,0.2),0px 7px 10px 1px rgba(0,0,0,0.14),0px 2px 16px 1px rgba(0,0,0,0.12);--mui-shadows-8:0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);--mui-shadows-9:0px 5px 6px -3px rgba(0,0,0,0.2),0px 9px 12px 1px rgba(0,0,0,0.14),0px 3px 16px 2px rgba(0,0,0,0.12);--mui-shadows-10:0px 6px 6px -3px rgba(0,0,0,0.2),0px 10px 14px 1px rgba(0,0,0,0.14),0px 4px 18px 3px rgba(0,0,0,0.12);--mui-shadows-11:0px 6px 7px -4px rgba(0,0,0,0.2),0px 11px 15px 1px rgba(0,0,0,0.14),0px 4px 20px 3px rgba(0,0,0,0.12);--mui-shadows-12:0px 7px 8px -4px rgba(0,0,0,0.2),0px 12px 17px 2px rgba(0,0,0,0.14),0px 5px 22px 4px rgba(0,0,0,0.12);--mui-shadows-13:0px 7px 8px -4px rgba(0,0,0,0.2),0px 13px 19px 2px rgba(0,0,0,0.14),0px 5px 24px 4px rgba(0,0,0,0.12);--mui-shadows-14:0px 7px 9px -4px rgba(0,0,0,0.2),0px 14px 21px 2px rgba(0,0,0,0.14),0px 5px 26px 4px rgba(0,0,0,0.12);--mui-shadows-15:0px 8px 9px -5px rgba(0,0,0,0.2),0px 15px 22px 2px rgba(0,0,0,0.14),0px 6px 28px 5px rgba(0,0,0,0.12);--mui-shadows-16:0px 8px 10px -5px rgba(0,0,0,0.2),0px 16px 24px 2px rgba(0,0,0,0.14),0px 6px 30px 5px rgba(0,0,0,0.12);--mui-shadows-17:0px 8px 11px -5px rgba(0,0,0,0.2),0px 17px 26px 2px rgba(0,0,0,0.14),0px 6px 32px 5px rgba(0,0,0,0.12);--mui-shadows-18:0px 9px 11px -5px rgba(0,0,0,0.2),0px 18px 28px 2px rgba(0,0,0,0.14),0px 7px 34px 6px rgba(0,0,0,0.12);--mui-shadows-19:0px 9px 12px -6px rgba(0,0,0,0.2),0px 19px 29px 2px rgba(0,0,0,0.14),0px 7px 36px 6px rgba(0,0,0,0.12);--mui-shadows-20:0px 10px 13px -6px rgba(0,0,0,0.2),0px 20px 31px 3px rgba(0,0,0,0.14),0px 8px 38px 7px rgba(0,0,0,0.12);--mui-shadows-21:0px 10px 13px -6px rgba(0,0,0,0.2),0px 21px 33px 3px rgba(0,0,0,0.14),0px 8px 40px 7px rgba(0,0,0,0.12);--mui-shadows-22:0px 10px 14px -6px rgba(0,0,0,0.2),0px 22px 35px 3px rgba(0,0,0,0.14),0px 8px 42px 7px rgba(0,0,0,0.12);--mui-shadows-23:0px 11px 14px -7px rgba(0,0,0,0.2),0px 23px 36px 3px rgba(0,0,0,0.14),0px 9px 44px 8px rgba(0,0,0,0.12);--mui-shadows-24:0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12);--mui-zIndex-mobileStepper:1000;--mui-zIndex-fab:1050;--mui-zIndex-speedDial:1050;--mui-zIndex-appBar:1100;--mui-zIndex-drawer:1200;--mui-zIndex-modal:1300;--mui-zIndex-snackbar:1400;--mui-zIndex-tooltip:1500;--mui-font-h1:300 6rem/1.167 var(--font-roboto);--mui-font-h2:300 3.75rem/1.2 var(--font-roboto);--mui-font-h3:400 3rem/1.167 var(--font-roboto);--mui-font-h4:400 2.125rem/1.235 var(--font-roboto);--mui-font-h5:400 1.5rem/1.334 var(--font-roboto);--mui-font-h6:500 1.25rem/1.6 var(--font-roboto);--mui-font-subtitle1:400 1rem/1.75 var(--font-roboto);--mui-font-subtitle2:500 0.875rem/1.57 var(--font-roboto);--mui-font-body1:400 1rem/1.5 var(--font-roboto);--mui-font-body2:400 0.875rem/1.43 var(--font-roboto);--mui-font-button:500 0.875rem/1.75 var(--font-roboto);--mui-font-caption:400 0.75rem/1.66 var(--font-roboto);--mui-font-overline:400 0.75rem/2.66 var(--font-roboto);--mui-font-inherit:inherit inherit/inherit inherit;}:root,.light{-webkit-print-color-scheme:light;color-scheme:light;--mui-palette-background-default:var(--background);--mui-palette-background-paper:var(--paper);--mui-palette-common-black:#000;--mui-palette-common-white:#fff;--mui-palette-common-background:#fff;--mui-palette-common-onBackground:#000;--mui-palette-common-backgroundChannel:255 255 255;--mui-palette-common-onBackgroundChannel:0 0 0;--mui-palette-primary-main:#1976d2;--mui-palette-primary-light:#42a5f5;--mui-palette-primary-dark:#1565c0;--mui-palette-primary-contrastText:#fff;--mui-palette-primary-mainChannel:25 118 210;--mui-palette-primary-lightChannel:66 165 245;--mui-palette-primary-darkChannel:21 101 192;--mui-palette-primary-contrastTextChannel:255 255 255;--mui-palette-secondary-main:#9c27b0;--mui-palette-secondary-light:#ba68c8;--mui-palette-secondary-dark:#7b1fa2;--mui-palette-secondary-contrastText:#fff;--mui-palette-secondary-mainChannel:156 39 176;--mui-palette-secondary-lightChannel:186 104 200;--mui-palette-secondary-darkChannel:123 31 162;--mui-palette-secondary-contrastTextChannel:255 255 255;--mui-palette-error-main:#d32f2f;--mui-palette-error-light:#ef5350;--mui-palette-error-dark:#c62828;--mui-palette-error-contrastText:#fff;--mui-palette-error-mainChannel:211 47 47;--mui-palette-error-lightChannel:239 83 80;--mui-palette-error-darkChannel:198 40 40;--mui-palette-error-contrastTextChannel:255 255 255;--mui-palette-warning-main:#ed6c02;--mui-palette-warning-light:#ff9800;--mui-palette-warning-dark:#e65100;--mui-palette-warning-contrastText:#fff;--mui-palette-warning-mainChannel:237 108 2;--mui-palette-warning-lightChannel:255 152 0;--mui-palette-warning-darkChannel:230 81 0;--mui-palette-warning-contrastTextChannel:255 255 255;--mui-palette-info-main:#0288d1;--mui-palette-info-light:#03a9f4;--mui-palette-info-dark:#01579b;--mui-palette-info-contrastText:#fff;--mui-palette-info-mainChannel:2 136 209;--mui-palette-info-lightChannel:3 169 244;--mui-palette-info-darkChannel:1 87 155;--mui-palette-info-contrastTextChannel:255 255 255;--mui-palette-success-main:#2e7d32;--mui-palette-success-light:#4caf50;--mui-palette-success-dark:#1b5e20;--mui-palette-success-contrastText:#fff;--mui-palette-success-mainChannel:46 125 50;--mui-palette-success-lightChannel:76 175 80;--mui-palette-success-darkChannel:27 94 32;--mui-palette-success-contrastTextChannel:255 255 255;--mui-palette-grey-50:#fafafa;--mui-palette-grey-100:#f5f5f5;--mui-palette-grey-200:#eeeeee;--mui-palette-grey-300:#e0e0e0;--mui-palette-grey-400:#bdbdbd;--mui-palette-grey-500:#9e9e9e;--mui-palette-grey-600:#757575;--mui-palette-grey-700:#616161;--mui-palette-grey-800:#424242;--mui-palette-grey-900:#212121;--mui-palette-grey-A100:#f5f5f5;--mui-palette-grey-A200:#eeeeee;--mui-palette-grey-A400:#bdbdbd;--mui-palette-grey-A700:#616161;--mui-palette-text-primary:rgba(0, 0, 0, 0.87);--mui-palette-text-secondary:rgba(0, 0, 0, 0.6);--mui-palette-text-disabled:rgba(0, 0, 0, 0.38);--mui-palette-text-primaryChannel:0 0 0;--mui-palette-text-secondaryChannel:0 0 0;--mui-palette-divider:rgba(0, 0, 0, 0.12);--mui-palette-action-active:rgba(0, 0, 0, 0.54);--mui-palette-action-hover:rgba(0, 0, 0, 0.04);--mui-palette-action-hoverOpacity:0.04;--mui-palette-action-selected:rgba(0, 0, 0, 0.08);--mui-palette-action-selectedOpacity:0.08;--mui-palette-action-disabled:rgba(0, 0, 0, 0.26);--mui-palette-action-disabledBackground:rgba(0, 0, 0, 0.12);--mui-palette-action-disabledOpacity:0.38;--mui-palette-action-focus:rgba(0, 0, 0, 0.12);--mui-palette-action-focusOpacity:0.12;--mui-palette-action-activatedOpacity:0.12;--mui-palette-action-activeChannel:0 0 0;--mui-palette-action-selectedChannel:0 0 0;--mui-palette-Alert-errorColor:rgb(95, 33, 32);--mui-palette-Alert-infoColor:rgb(1, 67, 97);--mui-palette-Alert-successColor:rgb(30, 70, 32);--mui-palette-Alert-warningColor:rgb(102, 60, 0);--mui-palette-Alert-errorFilledBg:var(--mui-palette-error-main, #d32f2f);--mui-palette-Alert-infoFilledBg:var(--mui-palette-info-main, #0288d1);--mui-palette-Alert-successFilledBg:var(--mui-palette-success-main, #2e7d32);--mui-palette-Alert-warningFilledBg:var(--mui-palette-warning-main, #ed6c02);--mui-palette-Alert-errorFilledColor:#fff;--mui-palette-Alert-infoFilledColor:#fff;--mui-palette-Alert-successFilledColor:#fff;--mui-palette-Alert-warningFilledColor:#fff;--mui-palette-Alert-errorStandardBg:rgb(253, 237, 237);--mui-palette-Alert-infoStandardBg:rgb(229, 246, 253);--mui-palette-Alert-successStandardBg:rgb(237, 247, 237);--mui-palette-Alert-warningStandardBg:rgb(255, 244, 229);--mui-palette-Alert-errorIconColor:var(--mui-palette-error-main, #d32f2f);--mui-palette-Alert-infoIconColor:var(--mui-palette-info-main, #0288d1);--mui-palette-Alert-successIconColor:var(--mui-palette-success-main, #2e7d32);--mui-palette-Alert-warningIconColor:var(--mui-palette-warning-main, #ed6c02);--mui-palette-AppBar-defaultBg:var(--mui-palette-grey-100, #f5f5f5);--mui-palette-Avatar-defaultBg:var(--mui-palette-grey-400, #bdbdbd);--mui-palette-Button-inheritContainedBg:var(--mui-palette-grey-300, #e0e0e0);--mui-palette-Button-inheritContainedHoverBg:var(--mui-palette-grey-A100, #f5f5f5);--mui-palette-Chip-defaultBorder:var(--mui-palette-grey-400, #bdbdbd);--mui-palette-Chip-defaultAvatarColor:var(--mui-palette-grey-700, #616161);--mui-palette-Chip-defaultIconColor:var(--mui-palette-grey-700, #616161);--mui-palette-FilledInput-bg:rgba(0, 0, 0, 0.06);--mui-palette-FilledInput-hoverBg:rgba(0, 0, 0, 0.09);--mui-palette-FilledInput-disabledBg:rgba(0, 0, 0, 0.12);--mui-palette-LinearProgress-primaryBg:rgb(167, 202, 237);--mui-palette-LinearProgress-secondaryBg:rgb(217, 172, 224);--mui-palette-LinearProgress-errorBg:rgb(238, 175, 175);--mui-palette-LinearProgress-infoBg:rgb(158, 209, 237);--mui-palette-LinearProgress-successBg:rgb(175, 205, 177);--mui-palette-LinearProgress-warningBg:rgb(248, 199, 158);--mui-palette-Skeleton-bg:rgba(var(--mui-palette-text-primaryChannel, undefined) / 0.11);--mui-palette-Slider-primaryTrack:rgb(167, 202, 237);--mui-palette-Slider-secondaryTrack:rgb(217, 172, 224);--mui-palette-Slider-errorTrack:rgb(238, 175, 175);--mui-palette-Slider-infoTrack:rgb(158, 209, 237);--mui-palette-Slider-successTrack:rgb(175, 205, 177);--mui-palette-Slider-warningTrack:rgb(248, 199, 158);--mui-palette-SnackbarContent-bg:var(--background);--mui-palette-SpeedDialAction-fabHoverBg:var(--paper);--mui-palette-StepConnector-border:var(--mui-palette-grey-400, #bdbdbd);--mui-palette-StepContent-border:var(--mui-palette-grey-400, #bdbdbd);--mui-palette-Switch-defaultColor:var(--mui-palette-common-white, #fff);--mui-palette-Switch-defaultDisabledColor:var(--mui-palette-grey-100, #f5f5f5);--mui-palette-Switch-primaryDisabledColor:rgb(167, 202, 237);--mui-palette-Switch-secondaryDisabledColor:rgb(217, 172, 224);--mui-palette-Switch-errorDisabledColor:rgb(238, 175, 175);--mui-palette-Switch-infoDisabledColor:rgb(158, 209, 237);--mui-palette-Switch-successDisabledColor:rgb(175, 205, 177);--mui-palette-Switch-warningDisabledColor:rgb(248, 199, 158);--mui-palette-TableCell-border:rgba(224, 224, 224, 1);--mui-palette-Tooltip-bg:rgba(97, 97, 97, 0.92);--mui-palette-dividerChannel:0 0 0;--mui-opacity-inputPlaceholder:0.42;--mui-opacity-inputUnderline:0.42;--mui-opacity-switchTrackDisabled:0.12;--mui-opacity-switchTrack:0.38;}.dark{-webkit-print-color-scheme:dark;color-scheme:dark;--mui-palette-common-black:#000;--mui-palette-common-white:#fff;--mui-palette-common-background:#000;--mui-palette-common-onBackground:#fff;--mui-palette-common-backgroundChannel:0 0 0;--mui-palette-common-onBackgroundChannel:255 255 255;--mui-palette-primary-main:#90caf9;--mui-palette-primary-light:#e3f2fd;--mui-palette-primary-dark:#42a5f5;--mui-palette-primary-contrastText:rgba(0, 0, 0, 0.87);--mui-palette-primary-mainChannel:144 202 249;--mui-palette-primary-lightChannel:227 242 253;--mui-palette-primary-darkChannel:66 165 245;--mui-palette-primary-contrastTextChannel:0 0 0;--mui-palette-secondary-main:#ce93d8;--mui-palette-secondary-light:#f3e5f5;--mui-palette-secondary-dark:#ab47bc;--mui-palette-secondary-contrastText:rgba(0, 0, 0, 0.87);--mui-palette-secondary-mainChannel:206 147 216;--mui-palette-secondary-lightChannel:243 229 245;--mui-palette-secondary-darkChannel:171 71 188;--mui-palette-secondary-contrastTextChannel:0 0 0;--mui-palette-error-main:#f44336;--mui-palette-error-light:#e57373;--mui-palette-error-dark:#d32f2f;--mui-palette-error-contrastText:#fff;--mui-palette-error-mainChannel:244 67 54;--mui-palette-error-lightChannel:229 115 115;--mui-palette-error-darkChannel:211 47 47;--mui-palette-error-contrastTextChannel:255 255 255;--mui-palette-warning-main:#ffa726;--mui-palette-warning-light:#ffb74d;--mui-palette-warning-dark:#f57c00;--mui-palette-warning-contrastText:rgba(0, 0, 0, 0.87);--mui-palette-warning-mainChannel:255 167 38;--mui-palette-warning-lightChannel:255 183 77;--mui-palette-warning-darkChannel:245 124 0;--mui-palette-warning-contrastTextChannel:0 0 0;--mui-palette-info-main:#29b6f6;--mui-palette-info-light:#4fc3f7;--mui-palette-info-dark:#0288d1;--mui-palette-info-contrastText:rgba(0, 0, 0, 0.87);--mui-palette-info-mainChannel:41 182 246;--mui-palette-info-lightChannel:79 195 247;--mui-palette-info-darkChannel:2 136 209;--mui-palette-info-contrastTextChannel:0 0 0;--mui-palette-success-main:#66bb6a;--mui-palette-success-light:#81c784;--mui-palette-success-dark:#388e3c;--mui-palette-success-contrastText:rgba(0, 0, 0, 0.87);--mui-palette-success-mainChannel:102 187 106;--mui-palette-success-lightChannel:129 199 132;--mui-palette-success-darkChannel:56 142 60;--mui-palette-success-contrastTextChannel:0 0 0;--mui-palette-grey-50:#fafafa;--mui-palette-grey-100:#f5f5f5;--mui-palette-grey-200:#eeeeee;--mui-palette-grey-300:#e0e0e0;--mui-palette-grey-400:#bdbdbd;--mui-palette-grey-500:#9e9e9e;--mui-palette-grey-600:#757575;--mui-palette-grey-700:#616161;--mui-palette-grey-800:#424242;--mui-palette-grey-900:#212121;--mui-palette-grey-A100:#f5f5f5;--mui-palette-grey-A200:#eeeeee;--mui-palette-grey-A400:#bdbdbd;--mui-palette-grey-A700:#616161;--mui-palette-text-primary:#fff;--mui-palette-text-secondary:rgba(255, 255, 255, 0.7);--mui-palette-text-disabled:rgba(255, 255, 255, 0.5);--mui-palette-text-icon:rgba(255, 255, 255, 0.5);--mui-palette-text-primaryChannel:255 255 255;--mui-palette-text-secondaryChannel:255 255 255;--mui-palette-divider:rgba(255, 255, 255, 0.12);--mui-palette-background-paper:var(--paper);--mui-palette-background-default:var(--background);--mui-palette-action-active:#fff;--mui-palette-action-hover:rgba(255, 255, 255, 0.08);--mui-palette-action-hoverOpacity:0.08;--mui-palette-action-selected:rgba(255, 255, 255, 0.16);--mui-palette-action-selectedOpacity:0.16;--mui-palette-action-disabled:rgba(255, 255, 255, 0.3);--mui-palette-action-disabledBackground:rgba(255, 255, 255, 0.12);--mui-palette-action-disabledOpacity:0.38;--mui-palette-action-focus:rgba(255, 255, 255, 0.12);--mui-palette-action-focusOpacity:0.12;--mui-palette-action-activatedOpacity:0.24;--mui-palette-action-activeChannel:255 255 255;--mui-palette-action-selectedChannel:255 255 255;--mui-palette-Alert-errorColor:rgb(244, 199, 199);--mui-palette-Alert-infoColor:rgb(184, 231, 251);--mui-palette-Alert-successColor:rgb(204, 232, 205);--mui-palette-Alert-warningColor:rgb(255, 226, 183);--mui-palette-Alert-errorFilledBg:var(--mui-palette-error-dark, #d32f2f);--mui-palette-Alert-infoFilledBg:var(--mui-palette-info-dark, #0288d1);--mui-palette-Alert-successFilledBg:var(--mui-palette-success-dark, #388e3c);--mui-palette-Alert-warningFilledBg:var(--mui-palette-warning-dark, #f57c00);--mui-palette-Alert-errorFilledColor:#fff;--mui-palette-Alert-infoFilledColor:#fff;--mui-palette-Alert-successFilledColor:#fff;--mui-palette-Alert-warningFilledColor:rgba(0, 0, 0, 0.87);--mui-palette-Alert-errorStandardBg:rgb(22, 11, 11);--mui-palette-Alert-infoStandardBg:rgb(7, 19, 24);--mui-palette-Alert-successStandardBg:rgb(12, 19, 13);--mui-palette-Alert-warningStandardBg:rgb(25, 18, 7);--mui-palette-Alert-errorIconColor:var(--mui-palette-error-main, #f44336);--mui-palette-Alert-infoIconColor:var(--mui-palette-info-main, #29b6f6);--mui-palette-Alert-successIconColor:var(--mui-palette-success-main, #66bb6a);--mui-palette-Alert-warningIconColor:var(--mui-palette-warning-main, #ffa726);--mui-palette-AppBar-defaultBg:var(--mui-palette-grey-900, #212121);--mui-palette-AppBar-darkBg:var(--mui-palette-background-paper, var(--paper));--mui-palette-AppBar-darkColor:var(--mui-palette-text-primary, #fff);--mui-palette-Avatar-defaultBg:var(--mui-palette-grey-600, #757575);--mui-palette-Button-inheritContainedBg:var(--mui-palette-grey-800, #424242);--mui-palette-Button-inheritContainedHoverBg:var(--mui-palette-grey-700, #616161);--mui-palette-Chip-defaultBorder:var(--mui-palette-grey-700, #616161);--mui-palette-Chip-defaultAvatarColor:var(--mui-palette-grey-300, #e0e0e0);--mui-palette-Chip-defaultIconColor:var(--mui-palette-grey-300, #e0e0e0);--mui-palette-FilledInput-bg:rgba(255, 255, 255, 0.09);--mui-palette-FilledInput-hoverBg:rgba(255, 255, 255, 0.13);--mui-palette-FilledInput-disabledBg:rgba(255, 255, 255, 0.12);--mui-palette-LinearProgress-primaryBg:rgb(72, 101, 124);--mui-palette-LinearProgress-secondaryBg:rgb(103, 73, 108);--mui-palette-LinearProgress-errorBg:rgb(122, 33, 27);--mui-palette-LinearProgress-infoBg:rgb(20, 91, 123);--mui-palette-LinearProgress-successBg:rgb(51, 93, 53);--mui-palette-LinearProgress-warningBg:rgb(127, 83, 19);--mui-palette-Skeleton-bg:rgba(var(--mui-palette-text-primaryChannel, undefined) / 0.13);--mui-palette-Slider-primaryTrack:rgb(72, 101, 124);--mui-palette-Slider-secondaryTrack:rgb(103, 73, 108);--mui-palette-Slider-errorTrack:rgb(122, 33, 27);--mui-palette-Slider-infoTrack:rgb(20, 91, 123);--mui-palette-Slider-successTrack:rgb(51, 93, 53);--mui-palette-Slider-warningTrack:rgb(127, 83, 19);--mui-palette-SnackbarContent-bg:var(--background);--mui-palette-SpeedDialAction-fabHoverBg:var(--paper);--mui-palette-StepConnector-border:var(--mui-palette-grey-600, #757575);--mui-palette-StepContent-border:var(--mui-palette-grey-600, #757575);--mui-palette-Switch-defaultColor:var(--mui-palette-grey-300, #e0e0e0);--mui-palette-Switch-defaultDisabledColor:var(--mui-palette-grey-600, #757575);--mui-palette-Switch-primaryDisabledColor:rgb(64, 90, 112);--mui-palette-Switch-secondaryDisabledColor:rgb(92, 66, 97);--mui-palette-Switch-errorDisabledColor:rgb(109, 30, 24);--mui-palette-Switch-infoDisabledColor:rgb(18, 81, 110);--mui-palette-Switch-successDisabledColor:rgb(45, 84, 47);--mui-palette-Switch-warningDisabledColor:rgb(114, 75, 17);--mui-palette-TableCell-border:rgba(81, 81, 81, 1);--mui-palette-Tooltip-bg:rgba(97, 97, 97, 0.92);--mui-palette-dividerChannel:255 255 255;--mui-opacity-inputPlaceholder:0.5;--mui-opacity-inputUnderline:0.7;--mui-opacity-switchTrackDisabled:0.2;--mui-opacity-switchTrack:0.3;--mui-overlays-0:none;--mui-overlays-1:linear-gradient(rgba(255 255 255 / 0.051), rgba(255 255 255 / 0.051));--mui-overlays-2:linear-gradient(rgba(255 255 255 / 0.069), rgba(255 255 255 / 0.069));--mui-overlays-3:linear-gradient(rgba(255 255 255 / 0.082), rgba(255 255 255 / 0.082));--mui-overlays-4:linear-gradient(rgba(255 255 255 / 0.092), rgba(255 255 255 / 0.092));--mui-overlays-5:linear-gradient(rgba(255 255 255 / 0.101), rgba(255 255 255 / 0.101));--mui-overlays-6:linear-gradient(rgba(255 255 255 / 0.108), rgba(255 255 255 / 0.108));--mui-overlays-7:linear-gradient(rgba(255 255 255 / 0.114), rgba(255 255 255 / 0.114));--mui-overlays-8:linear-gradient(rgba(255 255 255 / 0.119), rgba(255 255 255 / 0.119));--mui-overlays-9:linear-gradient(rgba(255 255 255 / 0.124), rgba(255 255 255 / 0.124));--mui-overlays-10:linear-gradient(rgba(255 255 255 / 0.128), rgba(255 255 255 / 0.128));--mui-overlays-11:linear-gradient(rgba(255 255 255 / 0.132), rgba(255 255 255 / 0.132));--mui-overlays-12:linear-gradient(rgba(255 255 255 / 0.135), rgba(255 255 255 / 0.135));--mui-overlays-13:linear-gradient(rgba(255 255 255 / 0.139), rgba(255 255 255 / 0.139));--mui-overlays-14:linear-gradient(rgba(255 255 255 / 0.142), rgba(255 255 255 / 0.142));--mui-overlays-15:linear-gradient(rgba(255 255 255 / 0.145), rgba(255 255 255 / 0.145));--mui-overlays-16:linear-gradient(rgba(255 255 255 / 0.147), rgba(255 255 255 / 0.147));--mui-overlays-17:linear-gradient(rgba(255 255 255 / 0.15), rgba(255 255 255 / 0.15));--mui-overlays-18:linear-gradient(rgba(255 255 255 / 0.152), rgba(255 255 255 / 0.152));--mui-overlays-19:linear-gradient(rgba(255 255 255 / 0.155), rgba(255 255 255 / 0.155));--mui-overlays-20:linear-gradient(rgba(255 255 255 / 0.157), rgba(255 255 255 / 0.157));--mui-overlays-21:linear-gradient(rgba(255 255 255 / 0.159), rgba(255 255 255 / 0.159));--mui-overlays-22:linear-gradient(rgba(255 255 255 / 0.161), rgba(255 255 255 / 0.161));--mui-overlays-23:linear-gradient(rgba(255 255 255 / 0.163), rgba(255 255 255 / 0.163));--mui-overlays-24:linear-gradient(rgba(255 255 255 / 0.165), rgba(255 255 255 / 0.165));}}</style><style data-emotion="mui 1i9nq8r 119n1kx 15xf1l2 1wpjpqx ldochk i9gxme prbfhc guxxgt 1elkboy 1no3677 1lfkwwt 0 1qgdhby py43je 1nmyhde 6jywu4 iguwhy 1x9wuxa 1ro4pr9 1f0nrkf 18io1cx">@layer mui{.mui-1i9nq8r{background-color:var(--mui-palette-background-default);}}@layer mui{.mui-119n1kx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:var(--mui-zIndex-appBar);top:0;left:auto;right:0;--AppBar-background:transparent;--AppBar-color:inherit;background-color:var(--AppBar-background);color:var(--AppBar-color);border-bottom:1px solid;border-color:var(--spacer);background-color:color-mix(in srgb, var(--background) 50%, transparent);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);}@media print{.mui-119n1kx{position:absolute;}}*:where(.dark) .mui-119n1kx{background-image:none;}}@layer mui{.mui-15xf1l2{background-color:var(--mui-palette-background-paper);color:var(--mui-palette-text-primary);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:var(--Paper-shadow);background-image:var(--Paper-overlay);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:var(--mui-zIndex-appBar);top:0;left:auto;right:0;--AppBar-background:transparent;--AppBar-color:inherit;background-color:var(--AppBar-background);color:var(--AppBar-color);border-bottom:1px solid;border-color:var(--spacer);background-color:color-mix(in srgb, var(--background) 50%, transparent);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);}@media print{.mui-15xf1l2{position:absolute;}}*:where(.dark) .mui-15xf1l2{background-image:none;}}@layer mui{.mui-1wpjpqx{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:calc(2 * var(--mui-spacing));padding-right:calc(2 * var(--mui-spacing));min-height:48px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}@media (min-width:600px){.mui-1wpjpqx{padding-left:calc(3 * var(--mui-spacing));padding-right:calc(3 * var(--mui-spacing));}}}@layer mui{.mui-ldochk{margin:0;font-family:var(--font-roboto);font-weight:500;font-size:1.25rem;line-height:1.6;color:var(--mui-palette-text-primary);}}@layer mui{.mui-i9gxme{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}}@layer mui{.mui-prbfhc{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-left:calc(5 * var(--mui-spacing));margin-right:calc(5 * var(--mui-spacing));}}@layer mui{.mui-guxxgt{margin:0;font-family:var(--font-roboto);font-weight:400;font-size:1rem;line-height:1.5;color:var(--mui-palette-text-primary);}}@layer mui{.mui-1elkboy{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:calc(2 * var(--mui-spacing));padding-right:calc(2 * var(--mui-spacing));min-height:48px;}@media (min-width:600px){.mui-1elkboy{padding-left:calc(3 * var(--mui-spacing));padding-right:calc(3 * var(--mui-spacing));}}}@layer mui{.mui-1no3677{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;padding-left:calc(2 * var(--mui-spacing));padding-right:calc(2 * var(--mui-spacing));}@media (min-width:600px){.mui-1no3677{padding-left:calc(3 * var(--mui-spacing));padding-right:calc(3 * var(--mui-spacing));}}@media (min-width:1200px){.mui-1no3677{max-width:1200px;}}}@layer mui{.mui-1lfkwwt{position:relative;margin-bottom:calc(2 * var(--mui-spacing));}@media (min-width:0px){.mui-1lfkwwt{width:100vw;margin-left:calc(-2 * var(--mui-spacing));margin-right:calc(-2 * var(--mui-spacing));height:300px;}}@media (min-width:600px){.mui-1lfkwwt{width:100%;margin-left:0;margin-right:0;height:600px;}}}@layer mui{.mui-1qgdhby{margin:0;font-family:var(--font-roboto);font-weight:300;font-size:3.75rem;line-height:1.2;color:var(--mui-palette-text-primary);font-weight:700;}@media (min-width:0px){.mui-1qgdhby{font-size:250%;}}@media (min-width:600px){.mui-1qgdhby{font-size:400%;}}}@layer mui{.mui-py43je{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.mui-py43je>:not(style):not(style){margin:0;}.mui-py43je>:not(style)~:not(style){margin-left:calc(4 * var(--mui-spacing));}}@layer mui{.mui-1nmyhde{margin:0;font-family:var(--font-roboto);font-weight:400;font-size:0.75rem;line-height:2.66;text-transform:uppercase;color:var(--mui-palette-text-primary);}}@layer mui{.mui-6jywu4{margin:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;border-width:0;border-style:solid;border-color:var(--mui-palette-divider);border-bottom-width:thin;}}@layer mui{.mui-iguwhy{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}}@layer mui{.mui-1x9wuxa{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;overflow:hidden;display:inline-block;text-align:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:1.5rem;-webkit-transform:translateY(6px);-moz-transform:translateY(6px);-ms-transform:translateY(6px);transform:translateY(6px);}}@layer mui{.mui-1ro4pr9{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;color:var(--mui-palette-success-main);font-size:13px;}}@layer mui{.mui-1f0nrkf{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;color:var(--mui-palette-warning-main);font-size:13px;}}@layer mui{.mui-18io1cx{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;color:var(--mui-palette-error-main);font-size:13px;}}</style></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable min-h-screen antialiased" style="padding-bottom:100px"><div hidden=""><!--$--><!--/$--></div><div class="min-h-screen w-full MuiBox-root mui-1i9nq8r"><nav class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation0 MuiAppBar-root MuiAppBar-colorTransparent MuiAppBar-positionFixed mui-fixed mui-15xf1l2" style="--Paper-shadow:var(--mui-shadows-0);--Paper-overlay:var(--mui-overlays-0)"><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-dense mui-1wpjpqx"><a class="no-underline" href="/"><h6 class="MuiTypography-root MuiTypography-h6 mui-ldochk">Antoine&#x27;s Blog</h6></a><div class="MuiBox-root mui-i9gxme"></div><div class="MuiBox-root mui-prbfhc"><a href="/about"><p class="MuiTypography-root MuiTypography-body1 mui-guxxgt">About</p></a></div></div></nav><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-dense mui-1elkboy"></div> <div class="MuiContainer-root MuiContainer-maxWidthLg mui-1no3677"><div class="MuiBox-root mui-1lfkwwt"><img alt="An image showing encrypted &amp; decrypted text" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" sizes="(max-width: 600px) 384px, 1080px" srcSet="/articles/crypto-llm/cover-384.webp 32w, /articles/crypto-llm/cover-384.webp 48w, /articles/crypto-llm/cover-384.webp 64w, /articles/crypto-llm/cover-384.webp 96w, /articles/crypto-llm/cover-384.webp 128w, /articles/crypto-llm/cover-384.webp 256w, /articles/crypto-llm/cover-384.webp 360w, /articles/crypto-llm/cover-384.webp 384w, /articles/crypto-llm/cover-1080.webp 1080w" src="/articles/crypto-llm/cover-1080.webp"/></div><div class="MuiBox-root mui-0"><h2 class="MuiTypography-root MuiTypography-h2 mui-1qgdhby">A method for text to text encryption using LLMs</h2><div class="MuiStack-root mui-py43je"><span class="MuiTypography-root MuiTypography-overline mui-1nmyhde" id="publication-date">1 February 2026</span><span class="MuiTypography-root MuiTypography-overline mui-1nmyhde" id="tags">deep learning | math | llm | crypto</span></div><hr class="MuiDivider-root MuiDivider-fullWidth mui-6jywu4"/></div><div class="MuiBox-root mui-0"><article class="prose dark:prose-invert"><p>In this article, I present a novel (and probably useless but fun) use of language models: <strong>encrypting text as text</strong>.</p>
<h1>Language models can be used to compress text</h1>
<p>Given a sequence of tokens, language models predict the probability distribution of the next token (if you’re unfamiliar with tokens, you can roughly think of them as words or word fragments). Because they define a conditional probability model over text, they can be used as the probabilistic component of an arithmetic coder to compress text (see, for example, <a href="https://github.com/AlexBuz/llama-zip">llama-zip</a>). An arithmetic coder is a compression algorithm that leverages a statistical model to make probable data take up less space than rare data.</p>
<p>When compression is effective, text is transformed into a seemingly unpredictable sequence of bits. Unpredictability is a hallmark of near-optimal compression. The arithmetic decoder then reconstructs the original text exactly. In practice, however, this application is mostly useless: the size of the model parameters typically dwarfs the size of any text worth compressing.</p>
<h1>Language models can be used to encode data as text</h1>
<p>This raises a more interesting question: can we do the opposite? That is, can we turn an arbitrary sequence of bits into text and later recover the original bits? If so, we could transmit any message that can be expressed as bits in the form of a plausible-looking text. Naturally, this is even less useful as it is simply a prohibitively expensive way to store binary data.</p>
<p>The main difficulty is that while arithmetic coding guarantees that:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>text</mtext><mo>→</mo><mtext>bits</mtext><mo>→</mo><mtext>text</mtext></mrow><annotation encoding="application/x-tex">\text{text} \rightarrow \text{bits} \rightarrow \text{text}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord text"><span class="mord">text</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">bits</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord text"><span class="mord">text</span></span></span></span></span></span>
<p>recovers the original text, it does <em>not</em> guarantee that</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>bits</mtext><mo>→</mo><mtext>text</mtext><mo>→</mo><mtext>bits</mtext></mrow><annotation encoding="application/x-tex">\text{bits} \rightarrow \text{text} \rightarrow \text{bits}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">bits</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord text"><span class="mord">text</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">bits</span></span></span></span></span></span>
<p>recovers the original bit sequence.</p>
<p>That said, we can design a variant of arithmetic coding that effectively reverses the roles of tokens and bits. At each step, the language model predicts a probability distribution over the next token. These probabilities define a partition of the interval <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>, where each token corresponds to a sub-interval whose length is proportional to its predicted probability. In standard arithmetic coding, bits are interpreted as choosing between sub-intervals; here, we instead interpret bits as selecting <em>tokens</em> via this probabilistic partition.</p>
<p>While the theory is straightforward, the implementation is not. The token vocabulary is large, and pathological behaviors start to appear when sampling low-probability tokens. In particular, the encoder sometimes produced a sequence of tokens that, once decoded into text and tokenized again, resulted in a <em>different</em> token sequence.</p>
<p>This is not a bug in the tokenizer, but a fundamental property: tokenization is not a bijection. It only guarantees</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>text</mtext><mo>=</mo><mtext>decode</mtext><mo stretchy="false">(</mo><mtext>encode</mtext><mo stretchy="false">(</mo><mtext>text</mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{text} = \text{decode}(\text{encode}(\text{text}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord text"><span class="mord">text</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">decode</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">encode</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">text</span></span><span class="mclose">))</span></span></span></span></span>
<p>but not</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>tokens</mtext><mo>=</mo><mtext>encode</mtext><mo stretchy="false">(</mo><mtext>decode</mtext><mo stretchy="false">(</mo><mtext>tokens</mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{tokens} = \text{encode}(\text{decode}(\text{tokens}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">tokens</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">encode</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">decode</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">tokens</span></span><span class="mclose">))</span></span></span></span></span>
<p>When I first realized this, I nearly gave up. However, there is a crucial observation: the language model is trained to produce token sequences that originate from the tokenizer. As a result, most high-probability tokens satisfy:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>tokens</mtext><mo>=</mo><mtext>encode</mtext><mo stretchy="false">(</mo><mtext>decode</mtext><mo stretchy="false">(</mo><mtext>tokens</mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{tokens} = \text{encode}(\text{decode}(\text{tokens}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">tokens</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">encode</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">decode</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">tokens</span></span><span class="mclose">))</span></span></span></span></span>
<p>To take advantage of this, I restricted sampling to a relatively conservative regime: <code>top_k = 200</code>, <code>top_p = 0.9</code>, and <code>temperature=0.9</code>. This eliminates most problematic tokens and yields well-behaved sequences that survive a decode–re-encode round trip.</p>
<h1>Using language models to encrypt text as text</h1>
<p>With these two codecs in hand (text → bits → text and bits → text → bits) it was finally time to make my dream come true: <strong>encrypting text as text</strong>.</p>
<p>At a high level, the pipeline is simply this:</p>
<pre><code>encryption: text → bits → encrypted bits → encrypted text
decryption: encrypted text → encrypted bits → bits → text
</code></pre>
<p>And each arrow is perfectly computable and reversible.</p>
<h1>Creating an encrypted chat protocol using the method</h1>
<p>To demonstrate the idea in a more playful setting, I simulated an encrypted chat application in which encrypted messages resemble ordinary messages. Making this work requires solving a few practical problems.</p>
<h2>Choosing a chat format</h2>
<p>First, we need a message format. I use the following:</p>
<pre><code>- A: message1
- B: message2
- A: message3
...
</code></pre>
<p>Each message is terminated by a <code>\n</code> token, which is explicitly forbidden inside messages. This provides a clear stopping condition for the decoder. Without an end-of-message token, decoding would have no natural termination point and would continue indefinitely.</p>
<h2>Making encrypted text finish gracefully</h2>
<p>It would be unfortunate if encrypted messages ended abruptly as soon as all bits were consumed. To avoid this, we treat <code>\n</code> as an end-of-sequence token. While there are still bits left to encode, <code>\n</code> is excluded from the token set. Once encoding is complete, <code>\n</code> is reintroduced, and generation continues until it is sampled, producing a clean and natural-looking ending.</p>
<h2>Choosing an encryption algorithm</h2>
<p>We also need an encryption algorithm that does not significantly inflate the message size. Ideally, the number of encrypted bits should be close to the number of original bits, since bit length is tied to entropy, and more bits often lead to longer sequences. A conversation with unusually high entropy might attract unwanted attention.</p>
<p>I decided to use AES in counter mode (AES-CTR). CTR mode behaves like a stream cipher: it XORs the plaintext with a pseudorandom keystream derived from AES, producing ciphertext that is indistinguishable from random under standard assumptions. Unlike authenticated modes, it introduces no padding or expansion beyond a fixed-size nonce. However, this nonce does not need to be secret; it only needs to be unique. I decided to use the number of previous messages as the nonce, avoiding the need to send it alongside the message. This ultimately reduces the number of bits that need to be encoded as text.</p>
<h2>Detecting whether a message is encrypted</h2>
<p>Finally, I needed a way to distinguish encrypted from plain messages. In my experimentation, decrypting a non-encrypted message has a high chance of failing the bits-to-text conversion because it often proposes tokens that would have been excluded from the <code>top_k</code> or <code>top_p</code> first tokens. I thus rely on this right now to determine if a message was encrypted or not. An alternative would be to prefix the encrypted message with a special token. During decoding, if the first token is this special token, the message is treated as unencrypted and displayed as-is.</p>
<h1>Demo time!</h1>
<p>Actions:</p>
<ul>
<li>You can switch between normal and encrypted mode with the <svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-iguwhy" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"></path></svg> / <span class="material-icons notranslate MuiIcon-root MuiIcon-fontSizeMedium material-symbols-outlined mui-1x9wuxa" aria-hidden="true">domino_mask</span></li>
<li>Switch user with <svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-iguwhy" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M6.99 11 3 15l3.99 4v-3H14v-2H6.99zM21 9l-3.99-4v3H10v2h7.01v3z"></path></svg> buton. - Delete all messages with
<svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-iguwhy" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"></path></svg> button.</li>
<li>Reset default conversation with <svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-iguwhy" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="m19 8-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4z"></path></svg> button</li>
<li>Change the decrypt conversation with the <svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-iguwhy" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M21 10h-8.35C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H13l2 2 2-2 2 2 4-4.04zM7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3"></path></svg> button - Send message by
pressing &quot;Enter&quot; or clicking on the <svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium mui-iguwhy" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"></path></svg></li>
</ul>
<p>The colored dot on each message indicates knowledge about encryption:</p>
<ul>
<li><svg class="MuiSvgIcon-root MuiSvgIcon-colorSuccess MuiSvgIcon-fontSizeMedium mui-1ro4pr9" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><circle cx="12" cy="12" r="8"></circle></svg>: Message is
not encrypted</li>
<li><svg class="MuiSvgIcon-root MuiSvgIcon-colorWarning MuiSvgIcon-fontSizeMedium mui-1f0nrkf" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><circle cx="12" cy="12" r="8"></circle></svg>: We don&#x27;t know
if the message is encrypted or not</li>
<li><svg class="MuiSvgIcon-root MuiSvgIcon-colorError MuiSvgIcon-fontSizeMedium mui-18io1cx" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><circle cx="12" cy="12" r="8"></circle></svg>: Message is
encrypted</li>
</ul>
<!-- --><hr class="MuiDivider-root MuiDivider-fullWidth mui-6jywu4"/></article></div></div><!--$--><!--/$--></div><script src="/_next/static/chunks/f1b4d49aa9e249c5.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[52669,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\"],\"default\"]\n3:I[17472,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\"],\"ThemeStoreProvider\"]\n4:I[17350,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\"],\"default\"]\n5:I[79606,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\"],\"default\"]\n6:I[19646,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n7:I[77324,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\"],\"default\"]\n8:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n9:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"OutletBoundary\"]\nc:\"$Sreact.suspense\"\ne:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"ViewportBoundary\"]\n10:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"MetadataBoundary\"]\n12:I[68027,[],\"default\"]\n:HL[\"/_next/static/chunks/96dc49eb77cf029f.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/ce62453a442c7f35-s.p.124b2306.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200\u0026icon_names=domino_mask\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"YSYJJyAFFhJV4-z7mWwHv\",\"c\":[\"\",\"posts\",\"deep-learning\",\"crypto-llm\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"deep-learning/crypto-llm\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/96dc49eb77cf029f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/55fdeabc380c794a.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"roboto_d24be3b7-module__pZO6tq__variable dark min-h-screen\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200\u0026icon_names=domino_mask\"}]}],[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable min-h-screen antialiased\",\"suppressHydrationWarning\":true,\"style\":{\"paddingBottom\":\"100px\"},\"children\":[\"$\",\"$L2\",null,{\"options\":{\"enableCssLayer\":true},\"children\":[\"$\",\"$L3\",null,{\"children\":[\"$\",\"$L4\",null,{\"theme\":\"$5\",\"disableTransitionOnChange\":true,\"noSsr\":true,\"defaultMode\":\"dark\",\"children\":[\"$\",\"$L6\",null,{\"className\":\"min-h-screen w-full\",\"sx\":{\"bgcolor\":\"background.default\"},\"children\":[[\"$\",\"$L7\",null,{}],[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]}]}]}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$La\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/fb65dc2edde1250e.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/acbad84493a0396b.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"/_next/static/chunks/8c93724b435ab242.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-3\",{\"src\":\"/_next/static/chunks/dab6b902f1f46a02.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$c\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@d\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L10\",null,{\"children\":[\"$\",\"$c\",null,{\"name\":\"Next.Metadata\",\"children\":\"$L11\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$12\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"13:I[52057,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n14:I[5500,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"Image\"]\n15:I[26863,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n16:I[614,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n17:I[36773,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"a:[\"$\",\"$L13\",null,{\"children\":[[\"$\",\"$L6\",null,{\"position\":\"relative\",\"width\":{\"xs\":\"100vw\",\"sm\":\"100%\"},\"marginBottom\":2,\"marginX\":{\"xs\":-2,\"sm\":0},\"height\":{\"xs\":300,\"sm\":600},\"children\":[[\"$\",\"$L14\",null,{\"src\":\"/articles/crypto-llm/cover.png\",\"alt\":\"An image showing encrypted \u0026 decrypted text\",\"fill\":true,\"style\":{\"objectFit\":\"cover\"},\"sizes\":\"(max-width: 600px) 384px, 1080px\",\"quality\":90}],null]}],[\"$\",\"$L6\",null,{\"children\":[[\"$\",\"$L15\",null,{\"variant\":\"h2\",\"sx\":{\"fontWeight\":\"bold\",\"fontSize\":{\"xs\":\"250%\",\"sm\":\"400%\"}},\"children\":\"A method for text to text encryption using LLMs\"}],[\"$\",\"$L16\",null,{\"direction\":\"row\",\"spacing\":4,\"children\":[[\"$\",\"$L15\",null,{\"id\":\"publication-date\",\"variant\":\"overline\",\"children\":\"1 February 2026\"}],[\"$\",\"$L15\",null,{\"id\":\"tags\",\"variant\":\"overline\",\"children\":\"deep learning | math | llm | crypto\"}]]}],[\"$\",\"$L17\",null,{}]]}],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"article\",null,{\"className\":\"prose dark:prose-invert\",\"children\":[[[\"$\",\"p\",null,{\"children\":[\"In this article, I present a novel (and probably useless but fun) use of language models: \",[\"$\",\"strong\",null,{\"children\":\"encrypting text as text\"}],\".\"]}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"Language models can be used to compress text\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Given a sequence of tokens, language models predict the probability distribution of the next token (if you’re unfamiliar with tokens, you can roughly think of them as words or word fragments). Because they define a conditional probability model over text, they can be used as the probabilistic component of an arithmetic coder to compress text (see, for example, \",[\"$\",\"a\",null,{\"href\":\"https://github.com/AlexBuz/llama-zip\",\"children\":\"llama-zip\"}],\"). An arithmetic coder is a compression algorithm that leverages a statistical model to make probable data take up less space than rare data.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"When compression is effective, text is transformed into a seemingly unpredictable sequence of bits. Unpredictability is a hallmark of near-optimal compression. The arithmetic decoder then reconstructs the original text exactly. In practice, however, this application is mostly useless: the size of the model parameters typically dwarfs the size of any text worth compressing.\"}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"Language models can be used to encode data as text\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This raises a more interesting question: can we do the opposite? That is, can we turn an arbitrary sequence of bits into text and later recover the original bits? If so, we could transmit any message that can be expressed as bits in the form of a plausible-looking text. Naturally, this is even less useful as it is simply a prohibitively expensive way to store binary data.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The main difficulty is that while arithmetic coding guarantees that:\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"text\"}],[\"$\",\"mo\",null,{\"children\":\"→\"}],[\"$\",\"mtext\",null,{\"children\":\"bits\"}],[\"$\",\"mo\",null,{\"children\":\"→\"}],[\"$\",\"mtext\",null,{\"children\":\"text\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{text} \\\\rightarrow \\\\text{bits} \\\\rightarrow \\\\text{text}\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6151em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"text\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"→\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"bits\"}]}],\"$L18\",\"$L19\",\"$L1a\"]}],\"$L1b\"]}]]}]}],\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\"],\"$L40\",null]}]}]]}]\n"])</script><script>self.__next_f.push([1,"41:I[92522,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n42:I[18594,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n43:I[23120,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n44:I[83388,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n45:I[4685,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n46:I[60597,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n47:I[52087,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n48:I[85301,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n49:I[51678,[\"/_next/static/chunks/f9fb6c03ee20c9cf.js\",\"/_next/static/chunks/55fdeabc380c794a.js\",\"/_next/static/chunks/fb65dc2edde1250e.js\",\"/_next/static/chunks/acbad84493a0396b.js\",\"/_next/static/chunks/8c93724b435ab242.js\",\"/_next/static/chunks/dab6b902f1f46a02.js\"],\"default\"]\n18:[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]\n19:[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"→\"}]\n1a:[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]\n1b:[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6151em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"text\"}]}]]}]\n1c:[\"$\",\"p\",null,{\"children\":[\"recovers the original text, it does \",[\"$\",\"em\",null,{\"children\":\"not\"}],\" guarantee that\"]}]\n"])</script><script>self.__next_f.push([1,"1d:[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"bits\"}],[\"$\",\"mo\",null,{\"children\":\"→\"}],[\"$\",\"mtext\",null,{\"children\":\"text\"}],[\"$\",\"mo\",null,{\"children\":\"→\"}],[\"$\",\"mtext\",null,{\"children\":\"bits\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{bits} \\\\rightarrow \\\\text{text} \\\\rightarrow \\\\text{bits}\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"bits\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"→\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6151em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"text\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"→\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"bits\"}]}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"p\",null,{\"children\":\"recovers the original bit sequence.\"}]\n"])</script><script>self.__next_f.push([1,"1f:[\"$\",\"p\",null,{\"children\":[\"That said, we can design a variant of arithmetic coding that effectively reverses the roles of tokens and bits. At each step, the language model predicts a probability distribution over the next token. These probabilities define a partition of the interval \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"[\"}],[\"$\",\"mn\",null,{\"children\":\"0\"}],[\"$\",\"mo\",null,{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mn\",null,{\"children\":\"1\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"]\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"[0,1]\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\"]\"}]]}]}]]}],\", where each token corresponds to a sub-interval whose length is proportional to its predicted probability. In standard arithmetic coding, bits are interpreted as choosing between sub-intervals; here, we instead interpret bits as selecting \",[\"$\",\"em\",null,{\"children\":\"tokens\"}],\" via this probabilistic partition.\"]}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"p\",null,{\"children\":[\"While the theory is straightforward, the implementation is not. The token vocabulary is large, and pathological behaviors start to appear when sampling low-probability tokens. In particular, the encoder sometimes produced a sequence of tokens that, once decoded into text and tokenized again, resulted in a \",[\"$\",\"em\",null,{\"children\":\"different\"}],\" token sequence.\"]}]\n21:[\"$\",\"p\",null,{\"children\":\"This is not a bug in the tokenizer, but a fundamental property: tokenization is not a bijection. It only guarantees\"}]\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"text\"}],[\"$\",\"mo\",null,{\"children\":\"=\"}],[\"$\",\"mtext\",null,{\"children\":\"decode\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mtext\",null,{\"children\":\"encode\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mtext\",null,{\"children\":\"text\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{text} = \\\\text{decode}(\\\\text{encode}(\\\\text{text}))\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6151em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"text\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"decode\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"encode\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"text\"}]}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\"))\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"p\",null,{\"children\":\"but not\"}]\n"])</script><script>self.__next_f.push([1,"24:[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"tokens\"}],[\"$\",\"mo\",null,{\"children\":\"=\"}],[\"$\",\"mtext\",null,{\"children\":\"encode\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mtext\",null,{\"children\":\"decode\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mtext\",null,{\"children\":\"tokens\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{tokens} = \\\\text{encode}(\\\\text{decode}(\\\\text{tokens}))\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"tokens\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"encode\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"decode\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"tokens\"}]}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\"))\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"25:[\"$\",\"p\",null,{\"children\":\"When I first realized this, I nearly gave up. However, there is a crucial observation: the language model is trained to produce token sequences that originate from the tokenizer. As a result, most high-probability tokens satisfy:\"}]\n"])</script><script>self.__next_f.push([1,"26:[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"tokens\"}],[\"$\",\"mo\",null,{\"children\":\"=\"}],[\"$\",\"mtext\",null,{\"children\":\"encode\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mtext\",null,{\"children\":\"decode\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mtext\",null,{\"children\":\"tokens\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{tokens} = \\\\text{encode}(\\\\text{decode}(\\\\text{tokens}))\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"tokens\"}]}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"encode\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"decode\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"tokens\"}]}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\"))\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"27:[\"$\",\"p\",null,{\"children\":[\"To take advantage of this, I restricted sampling to a relatively conservative regime: \",[\"$\",\"code\",null,{\"children\":\"top_k = 200\"}],\", \",[\"$\",\"code\",null,{\"children\":\"top_p = 0.9\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"temperature=0.9\"}],\". This eliminates most problematic tokens and yields well-behaved sequences that survive a decode–re-encode round trip.\"]}]\n28:[\"$\",\"h1\",null,{\"children\":\"Using language models to encrypt text as text\"}]\n29:[\"$\",\"p\",null,{\"children\":[\"With these two codecs in hand (text → bits → text and bits → text → bits) it was finally time to make my dream come true: \",[\"$\",\"strong\",null,{\"children\":\"encrypting text as text\"}],\".\"]}]\n2a:[\"$\",\"p\",null,{\"children\":\"At a high level, the pipeline is simply this:\"}]\n2b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"encryption: text → bits → encrypted bits → encrypted text\\ndecryption: encrypted text → encrypted bits → bits → text\\n\"}]}]\n2c:[\"$\",\"p\",null,{\"children\":\"And each arrow is perfectly computable and reversible.\"}]\n2d:[\"$\",\"h1\",null,{\"children\":\"Creating an encrypted chat protocol using the method\"}]\n2e:[\"$\",\"p\",null,{\"children\":\"To demonstrate the idea in a more playful setting, I simulated an encrypted chat application in which encrypted messages resemble ordinary messages. Making this work requires solving a few practical problems.\"}]\n2f:[\"$\",\"h2\",null,{\"children\":\"Choosing a chat format\"}]\n30:[\"$\",\"p\",null,{\"children\":\"First, we need a message format. I use the following:\"}]\n31:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"- A: message1\\n- B: message2\\n- A: message3\\n...\\n\"}]}]\n32:[\"$\",\"p\",null,{\"children\":[\"Each message is terminated by a \",[\"$\",\"code\",null,{\"children\":\"\\\\n\"}],\" token, which is explicitly forbidden inside messages. This provides a clear stopping condition for the decoder. Without an end-of-message token, decoding would have no natural termination point and would continue indefinitely.\"]}]\n33:[\"$\",\"h2\",null,{\"children\":\"Making encrypted text finish gracefully\"}]\n34:[\"$\",\"p\",null,{\"children\":[\"It would be unfortunate if encrypted messages ended abruptly as soon as all bits were consumed. To avoid this, we treat \",[\"$\",\"code\",null,{\"children\":\"\\\\n\"}],\" as an end-of-sequence token. While there are still bits left to encode, \",[\"$\",\"code\",null,{\"children\":\"\\\\n\"}],\" is excluded from the token set. Once encoding is complete, \",[\"$\",\"code\",null,{\"children\":\"\\\\n\"}],\" is reintroduced, and generation continues until it is sampled, producing a clean and natural-looking ending.\"]}]\n35:[\"$\",\"h2\",null,{\"children\":\"Choosing an encryption algorithm\"}]\n36:[\"$\",\"p\",null,{\"children\":\"We also need an encryption algorithm that does not significantly inflate the message size. Ideally, the number of encrypted bits should be close to the number of original bits, since bit length is tied to entropy, and more bits often lead to longer sequences. A conversation with unusually high entropy might attract unwanted attention.\"}]\n37:[\"$\",\"p\",null,{\"children\":\"I decided to use AES in counter mode (AES-CTR). CTR mode behaves like a stream cipher: it XORs the plaintext with a pseudorandom keystream derived from AES, producing ciphertext that is indistinguishable from random under standard assumptions. Unlike authenticated modes, it introduces no padding or expansion beyond a fixed-size nonce. However, this nonce does not need to be secret; it only needs to be unique. I decided to use the number of previous messages as the nonce, avoiding the need to send it alongside the message. This ultimately reduces the number of bits that need to be encoded as text.\"}]\n38:[\"$\",\"h2\",null,{\"children\":\"Detecting whether a message is encrypted\"}]\n39:[\"$\",\"p\",null,{\"children\":[\"Finally, I needed a way to distinguish encrypted from plain messages. In my experimentation, decrypting a non-encrypted message has a high chance of failing the bits-to-text conversion because it often proposes tokens that would have been excluded from the \",[\"$\",\"code\",null,{\"children\":\"top_k\"}],\" or \",[\"$\",\"code\",null,{\"chi"])</script><script>self.__next_f.push([1,"ldren\":\"top_p\"}],\" first tokens. I thus rely on this right now to determine if a message was encrypted or not. An alternative would be to prefix the encrypted message with a special token. During decoding, if the first token is this special token, the message is treated as unencrypted and displayed as-is.\"]}]\n3a:[\"$\",\"h1\",null,{\"children\":\"Demo time!\"}]\n3b:[\"$\",\"p\",null,{\"children\":\"Actions:\"}]\n3c:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"You can switch between normal and encrypted mode with the \",[\"$\",\"$L41\",null,{}],\" / \",[\"$\",\"$L42\",null,{\"className\":\"material-symbols-outlined\",\"component\":\"span\",\"sx\":{\"transform\":\"translateY(6px)\"},\"children\":\"domino_mask\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Switch user with \",[\"$\",\"$L43\",null,{}],\" buton. - Delete all messages with\\n\",[\"$\",\"$L44\",null,{}],\" button.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Reset default conversation with \",[\"$\",\"$L45\",null,{}],\" button\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Change the decrypt conversation with the \",[\"$\",\"$L46\",null,{}],\" button - Send message by\\npressing \\\"Enter\\\" or clicking on the \",[\"$\",\"$L47\",null,{}]]}],\"\\n\"]}]\n3d:[\"$\",\"p\",null,{\"children\":\"The colored dot on each message indicates knowledge about encryption:\"}]\n3e:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"$L48\",null,{\"color\":\"success\",\"sx\":{\"fontSize\":13}}],\": Message is\\nnot encrypted\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"$L48\",null,{\"color\":\"warning\",\"sx\":{\"fontSize\":13}}],\": We don't know\\nif the message is encrypted or not\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"$L48\",null,{\"color\":\"error\",\"sx\":{\"fontSize\":13}}],\": Message is\\nencrypted\"]}],\"\\n\"]}]\n3f:[\"$\",\"$L49\",null,{}]\n40:[\"$\",\"$L17\",null,{}]\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"4a:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"IconMark\"]\nd:null\n11:[[\"$\",\"title\",\"0\",{\"children\":\"Antoine's Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"A blog where I share my thoughts about deep learning and my interests.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.722d4cfd.ico\",\"sizes\":\"257x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L4a\",\"3\",{}]]\n"])</script></body></html>